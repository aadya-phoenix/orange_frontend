<div id="right-panel" class="right-panel">
  <app-header></app-header>
  <div class="breadcrumbs cm_breadcums">
    <div class="col-sm-7">
      <div class="page-header float-left">
        <div class="page-title d-flex align-items-center">
          <img src="../../../../assets/images/second.jpg" class="home_Css_img" />
          <div class="d-flex flex-column ml-3">
            <span class="breade_text_span1">Gold access request</span>
            <span class="divider"></span>
            <span class="breade_text_span">{{lableConstant.request_create_session}}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="col-sm-5 float-right">
      <div class="page-header float-right">
        <div class="page-title d-flex end_just">
          <ol class="breadcrumb text-right">
            <li>
              <a [routerLink]="['/']" class="text_white">
                <i class="fa fa-home" aria-colcount=""></i> {{lableConstant.home}}
              </a>
            </li>
            <li>
              <a [routerLink]="['/gold-tool']" class="text_white">Gold access request</a>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>
  <!-- Button trigger modal -->
  <div class="content mt-2">
    <div class="animated fadeIn">
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header card_header_common">
              <div class="overall_css">
                <span class="card_overall">{{lableConstant.Overall_request_Status}}</span>
                <div class="cct_button_oversta">
                  <button class="btn btn-primary ml-1" [routerLink]="['/gold-tool/create']">
                    {{lableConstant.New_Request}}
                  </button>
                </div>
              </div>
            </div>
            <div class="card-body card_course_body">
              <div class="Course_icon_parent" data-aos="fade-right">
                <div class="Course_icon_child">
                  <div class="alig_dashicon" (click)="getrecords(goldToolStatus.draft)">
                    <div class="sub-child-dashicon">
                      <div class="fa-icons-des bac_blue">
                        <img src="../../../../assets/images/icon/drafts.png" />
                      </div>
                      <p>Draft</p>
                    </div>
                    <span class="number_css">{{gold_tool_count.draft}}</span>
                  </div>
                </div>
                <!--coled-->
                <div class="Course_icon_child">
                  <div class="alig_dashicon" (click)="getrecords(goldToolStatus.submitted)">
                    <div class="sub-child-dashicon">
                      <div class="fa-icons-des bac_puple">
                        <img src="../../../../assets/images/icon/closed.png" />
                      </div>
                      <p>Submitted</p>
                    </div>
                    <span class="number_css">{{gold_tool_count.submit}}</span>
                  </div>
                </div>
                <!--coled-->
                <div class="Course_icon_child">
                  <div class="alig_dashicon" (click)="getrecords(goldToolStatus.pending)">
                    <div class="sub-child-dashicon">
                      <div class="fa-icons-des bac_yellow">
                        <img src="../../../../assets/images/icon/pending.png" />
                      </div>
                      <p>Pending</p>
                    </div>
                    <span class="number_css">{{gold_tool_count.pending}}</span>
                  </div>
                </div>

                <!--coled-->
                <div class="Course_icon_child">
                  <div class="alig_dashicon" (click)="getrecords(goldToolStatus.closed)">
                    <div class="sub-child-dashicon">
                      <div class="fa-icons-des bac_green">
                        <img src="../../../../assets/images/icon/check.png" />
                      </div>
                      <p>Closed</p>
                    </div>
                    <span class="number_css">{{gold_tool_count.close}}</span>
                  </div>
                </div>
                <!--coled-->
                <div class="Course_icon_child">
                  <div class="alig_dashicon" (click)="getrecords(goldToolStatus.rejected)">
                    <div class="sub-child-dashicon">
                      <div class="fa-icons-des bac_pink">
                        <img src="../../../../assets/images/icon/reject.png" />
                      </div>
                      <p>Rejected</p>
                    </div>
                    <span class="number_css">{{gold_tool_count.reject}}</span>
                  </div>
                </div>
                <!--coled-->
                <div class="Course_icon_child">
                  <div class="alig_dashicon" (click)="getrecords(goldToolStatus.total)">
                    <div class="sub-child-dashicon">
                      <div class="fa-icons-des bac_blue1">
                        <img src="../../../../assets/images/icon/viewall.png" />
                      </div>
                      <p>View All</p>
                    </div>
                    <span class="number_css">{{gold_tool_count.total}}</span>
                  </div>
                </div>
                <!--coled-->
              </div>
              <!--ROW END-->
            </div>
          </div>
        </div>
      </div>
      <!-- .animated -->
    </div>
    <!-- .content -->
  </div>
  <div class="content">
    <div class="animated fadeIn">
      <div class="row">
        <div class="col-md-12">
          <div class="card">
            <div class="card-header card_header_common">
              <div class="overall_css">
                <div>
                  <i class="fa fa-table fa_table" aria-hidden="true "></i>
                  <span class="card-title card-title-text card_overall">Quick View</span>
                </div>

                <div _ngcontent-cue-c109=" " class="form-group filter_course mr-0">
                  <label _ngcontent-cue-c109=" " class="label_course color-black ">{{lableConstant.Search}}</label>
                  <input type="text " name="search " autocomplete="off" [(ngModel)]="searchText"
                    placeholder="Type to Search" class="form-control ng-untouched ng-pristine ng-valid form_width"
                    ng-reflect-name="search" />
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive table_height_scroll">
                <table id="bootstrap-data-table-export " class="table table-striped table-bordered">
                  <thead class="sticky_header">
                    <tr class="text-center fon_13">
                      <th>
                      </th>
                      <th sortable="request_id" (sort)="onSort($event)">
                        Requesd Id
                        <i class="fa fa-long-arrow-up arrow_css" aria-hidden="true "></i>
                        <i class="fa fa-long-arrow-down arrow_css" aria-hidden="true "></i>
                      </th>
                      <th sortable="requester_name" (sort)="onSort($event)">
                        Name
                        <i class="fa fa-long-arrow-up arrow_css" aria-hidden="true "></i>
                        <i class="fa fa-long-arrow-down arrow_css" aria-hidden="true "></i>
                      </th>

                      <th sortable="requester_email" (sort)="onSort($event)" class="corse_title">
                        Email Id<i class="fa fa-long-arrow-up arrow_css" aria-hidden="true"></i>
                        <i class="fa fa-long-arrow-down arrow_css" aria-hidden="true"></i>
                      </th>
                      <th>
                        Total Request
                      </th>
                      <th>
                        No of HRBP approved
                      </th>
                      <th>
                        Permission granted
                      </th>
                      <th sortable="created_at" (sort)="onSort($event)">
                        Created date
                        <i class="fa fa-long-arrow-up arrow_css" aria-hidden="true "></i>
                        <i class="fa fa-long-arrow-down arrow_css" aria-hidden="true "></i>
                      </th>
                      <th sortable="updated_at" (sort)="onSort($event)">
                        Last modified date<i class="fa fa-long-arrow-up arrow_css" aria-hidden="true "></i>
                        <i class="fa fa-long-arrow-down arrow_css" aria-hidden="true "></i>
                      </th>
                      <th class="text-center">{{lableConstant.history}}</th>
                      <th class="text-center">{{lableConstant.Status}}</th>
                      <th class="text-center">{{lableConstant.actions}}</th>
                    </tr>
                  </thead>
                  <tbody
                    *ngFor="let tool of goldToolListToView | filter: searchText  | paginate: { itemsPerPage: pagination.pageSize, currentPage: pagination.pageNumber } ; let rowIndex = index">
                    <tr class="text-center bac_hover-table fon_12">
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">
                        <span *ngIf="isRowClickable(rowIndex)">
                          <span *ngIf="expanded[tool.id]">-</span>
                          <span *ngIf="!expanded[tool.id]">+</span>
                        </span>
                      </td>
                      <td class="re_id" (click)="viewRequest(tool)">{{tool.request_id}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.requester_name}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.requester_email}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.count.total}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.count.hrbp_approve}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.count.grant}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.created_at | date: dateTimeFormate}}</td>
                      <td (click)="expanded[tool.id] = !expanded[tool.id]">{{tool.updated_at | date: dateTimeFormate}}</td>
                      <td>
                        <a (click)="openModal(tool)" class="re_id">
                          {{lableConstant.view}}
                        </a>
                      </td>
                      <td class="text-center">
                        <p [ngClass]="tool.status" class="text_yellow">
                          {{ tool.status | titlecase }}
                        </p>
                      </td>
                      <td class="text-center">
                        <div class="status_med_di">
                          <a class="copy_file mr-1" data-toggle="tooltip" (click)="viewRequest(tool)"
                            data-placement="top" title="View">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                          </a>
                        </div>
                      </td>
                    </tr>
                    <tr *ngIf="expanded[tool.id]">
                      <td colspan="12">
                        <table class="table table-striped table-bordered mb-0">
                          <thead class="sticky_header_gold">
                            <tr class="text-center fon_13">
                              <th>Name of participants</th>
                              <th>Email addresses for participants</th>
                              <th>CUID/FTID</th>
                              <!-- <th>P1</th> -->
                              <th>Region</th>
                              <th>Country</th>
                              <th>Gold level of access </th>
                              <th>HRBP email</th>
                              <th>Business justification </th>
                              <th>HRBP status </th>
                              <th *ngIf="!isHRBP">Gold Team Status</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr class="text-center bac_hover-table fon_12" *ngFor="let item of tool.metadata">
                              <td>{{item.name}}</td>
                              <td>{{item.email_for_participant}}</td>
                              <td>{{item.cuid_ftid}}</td>
                              <!-- <td>{{item.p1}}</td> -->
                              <td>{{item.region}}</td>
                              <td>{{item.country}}</td>
                              <td>{{item.gold_level_access}}</td>
                              <td>{{item.hrbp_email}}</td>
                              <td>{{item.business_justification}}</td>
                              <td>
                                <p [ngClass]="item.hrbp_status" *ngIf="!isHRBP">
                                  {{ item.hrbp_status | titlecase }}
                                </p>
                                <select class="form-control form_width" *ngIf="isHRBP" [(ngModel)]="item.hrbp_status">
                                  <option value="pending">Pening</option>
                                  <option value="approve">Approved</option>
                                  <option value="reject">Reject</option>
                                </select>
                              </td>
                              <td *ngIf="!isHRBP">
                                <p [ngClass]="item.status" *ngIf="!isGoldTeam">
                                  {{ item.status | titlecase }}
                                </p>
                                <select class="form-control form_width" *ngIf="isGoldTeam"
                                  [disabled]="item.hrbp_status != 'approve'" [(ngModel)]="item.status">
                                  <option value="pending">Pening</option>
                                  <option value="grant">Grant Permission</option>
                                  <option value="reject">Reject</option>
                                </select>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="pagiantio_dispaly">
                <div class="pagintion_ child">
                  <p class="cm-pagination-fotter">{{showPaginationCount(((pagination.pageSize *
                    (pagination.pageNumber - 1)) + 1),
                    ((this.pagination.pageSize * this.pagination.pageNumber) >
                    this.goldToolListToView?.length ? this.goldToolListToView?.length :
                    this.pagination.pageSize * this.pagination.pageNumber),
                    this.goldToolListToView?.length)}}</p>
                </div>
                <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- .animated -->
  </div>
</div>